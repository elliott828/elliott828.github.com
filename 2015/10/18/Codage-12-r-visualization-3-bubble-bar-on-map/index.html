<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="google-site-verification" content="-hIKy4njeS0VoSYzKTofmv6kqKt5CyTP4IVIlIWh1N0" />
<meta name="baidu-site-verification" content="14CLULlEjC" />


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>




  <meta name="keywords" content="R,ggvis,visualization,ggplot2," />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="Keep exploring the things we can do on a map with ggplot2 and ggvis.">
<meta property="og:type" content="article">
<meta property="og:title" content="R Visual. - Bubbles and Bar Charts on China Map">
<meta property="og:url" content="http://elliott828.github.io/2015/10/18/Codage-12-r-visualization-3-bubble-bar-on-map/index.html">
<meta property="og:site_name" content="Exity">
<meta property="og:description" content="Keep exploring the things we can do on a map with ggplot2 and ggvis.">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot1.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot2.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot3.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot4.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot5.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot6.png">
<meta property="og:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot7.png">
<meta property="og:updated_time" content="2015-11-13T07:01:41.979Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="R Visual. - Bubbles and Bar Charts on China Map">
<meta name="twitter:description" content="Keep exploring the things we can do on a map with ggplot2 and ggvis.">
<meta name="twitter:image" content="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot1.png">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>

  <title> R Visual. - Bubbles and Bar Charts on China Map | Exity </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '68396327-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?00cfd9a9530e4098a08a17043202505a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Exity</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
    <div class="site-search">
      
  
  <form class="site-search-form">
    <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
  </form>


<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'f-s39SMgF52UH9GHejVp','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              R Visual. - Bubbles and Bar Charts on China Map
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-18T23:24:12+08:00" content="2015-10-18">
            2015-10-18
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Codage-编程/" itemprop="url" rel="index">
                  <span itemprop="name">Codage|编程</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/10/18/Codage-12-r-visualization-3-bubble-bar-on-map/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/10/18/Codage-12-r-visualization-3-bubble-bar-on-map/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p>Keep exploring the things we can do on a map with <code>ggplot2</code> and <code>ggvis</code>.</p>
<a id="more"></a>
<p>About visualization on a map:</p>
<ul>
<li><a href="http://papacochon.com/2015/10/10/Codage-10-r-visualization-1-cn-map-1/" target="_blank" rel="external">R Visualization Series - China Map Part I</a></li>
<li><a href="http://papacochon.com/2015/10/15/Codage-11-r-visualization-2-cn-map-2/" target="_blank" rel="external">R Visualization Series - China Map Part II</a></li>
</ul>
<p>The data to be used:</p>
<ul>
<li><p>China map shape file:</p>
<ul>
<li><a href="http://note.youdao.com/share/?id=1d7447acad7976a355d795f1dea6abbf&amp;type=note" target="_blank" rel="external"><code>bou2_4p.shp</code></a></li>
<li><a href="http://note.youdao.com/share/?id=ea75b3342d26a4b93def35635899d8dd&amp;type=note" target="_blank" rel="external"><code>bou2_4p.dbf</code></a></li>
<li><a href="http://note.youdao.com/share/?id=3d1e0c02ab9cde35125880a6e440e9c2&amp;type=note" target="_blank" rel="external"><code>bou2_4p.shx</code></a></li>
</ul>
</li>
<li><p>China demographic of 6 censuses:</p>
<ul>
<li><a href="http://note.youdao.com/share/?id=81c4a0e4ea281d0ff96e61f7cc1f88f9&amp;type=note" target="_blank" rel="external"><code>DemoChina.csv</code></a></li>
</ul>
</li>
<li><p>The coordinates of province capitals in China:</p>
<ul>
<li><a href="http://note.youdao.com/share/?id=3fa56717b7f98bacdcde045a2254b365&amp;type=note" target="_blank" rel="external"><code>prov_capital.csv</code></a></li>
</ul>
</li>
<li><p>The private vehicle ownership per province (source: <a href="http://data.stats.gov.cn/easyquery.htm?cn=E0103" target="_blank" rel="external">NBSC</a>, Unit: k; Year: 1998, 2003, 2008, 2013; Hong Kong, Macau &amp; Taiwan excl.):</p>
<ul>
<li><a href="http://note.youdao.com/share/?id=ce748a9f4ee26786eb4f945eef17f56a&amp;type=note" target="_blank" rel="external"><code>car_ownership.csv</code></a></li>
</ul>
</li>
</ul>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><p>Load packages and set the language environment:<br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(maptools)</div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line"><span class="keyword">library</span>(ggplot2)</div><div class="line"><span class="keyword">library</span>(ggvis)</div><div class="line"></div><div class="line">Sys.setlocale(<span class="string">"LC_ALL"</span>, <span class="string">"chinese"</span>)</div></pre></td></tr></table></figure></p>
<figure class="highlight mizar"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">## [1] "LC_COLLATE=Chinese (Simplified)_People's Republic <span class="keyword">of</span> China.936;LC_CTYPE=Chinese (Simplified)_People's Republic <span class="keyword">of</span> China.936;LC_MONETARY=Chinese (Simplified)_People's Republic <span class="keyword">of</span> China.936;LC_NUMERIC=C;LC_TIME=Chinese (Simplified)_People's Republic <span class="keyword">of</span> China.936"</div></pre></td></tr></table></figure>
<p>Load and clean the raw data. Get 2 data frame <code>cnmapdf</code> and <code>cap_coord</code> as we did in the <a href="http://papacochon.com/2015/10/15/Codage-11-r-visualization-2-cn-map-2/" target="_blank" rel="external">previous visualization article</a>.</p>
<p>As we are going to draw pie and bar chart for each province, we need to add a bit more information to <code>cap_coord</code>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">car_prov &lt;- read.csv(<span class="string">"car_ownership.csv"</span>, stringsAsFactors = <span class="literal">F</span>)</div><div class="line"></div><div class="line">cap_bubble &lt;- cap_coord                                                 %&gt;%</div><div class="line">  plyr::join(subset(car_prov, year == <span class="number">2013</span>), by = <span class="string">"prov_en"</span>)            %&gt;%</div><div class="line">  na.omit()</div><div class="line"></div><div class="line">cap_bar &lt;- cap_coord                                                    %&gt;%</div><div class="line">  plyr::join(car_prov, by = <span class="string">"prov_en"</span>)                                  %&gt;%</div><div class="line">  na.omit()                                                             %&gt;%</div><div class="line">  filter(city_en %<span class="keyword">in</span>% c(<span class="string">"Beijing"</span>, <span class="string">"Shanghai"</span>, <span class="string">"Guangzhou"</span>, <span class="string">"Chengdu"</span>)) %&gt;%</div><div class="line">  mutate(year = paste(<span class="string">"Y"</span>, year, sep = <span class="string">""</span>))                             %&gt;%</div><div class="line">  tidyr::spread(year, no_car_k)</div></pre></td></tr></table></figure>
<h2 id="Bubbles-on-A-Map"><a href="#Bubbles-on-A-Map" class="headerlink" title="Bubbles on A Map"></a>Bubbles on A Map</h2><h3 id="Bubbles-with-A-Single-Color-ggplot2"><a href="#Bubbles-with-A-Single-Color-ggplot2" class="headerlink" title="Bubbles with A Single Color - ggplot2"></a>Bubbles with A Single Color - <code>ggplot2</code></h3><p>A bubble can be considered as a point, of which the size is controlled by the car ownership statistics.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ggplot()                                                                 +</div><div class="line">  geom_polygon(data = cnmapdf, aes(long, lat, group = group), </div><div class="line">               fill = <span class="string">"skyblue"</span>, colour = <span class="string">"grey"</span>)                        +</div><div class="line">  geom_point(data = cap_bubble, aes(cap_long, cap_lat, size = no_car_k), </div><div class="line">             shape = <span class="number">21</span>, fill = <span class="string">"red"</span>, alpha = <span class="number">.5</span>)                       +</div><div class="line">  scale_size_area(max_size=<span class="number">20</span>)</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot1.png" alt="vis3-plot1"></p>
<h3 id="Bubbles-with-Effect-of-Heat-Map-ggplot2"><a href="#Bubbles-with-Effect-of-Heat-Map-ggplot2" class="headerlink" title="Bubbles with Effect of Heat Map - ggplot2"></a>Bubbles with Effect of Heat Map - <code>ggplot2</code></h3><p>Calculate the growth rate the private car from 2008 to 2013, assign the data to argument <code>fill</code> of <code>geom_point()</code>.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cap_bubble[<span class="string">"growth"</span>] &lt;- subset(car_prov, year == <span class="number">2013</span>)[,<span class="number">3</span>,drop = <span class="literal">F</span>] / </div><div class="line">  subset(car_prov, year == <span class="number">2008</span>)[,<span class="number">3</span>,drop = <span class="literal">F</span>]-<span class="number">1</span></div><div class="line"></div><div class="line">ggplot()                                                                 +</div><div class="line">  geom_polygon(data = cnmapdf, aes(long, lat, group = group), </div><div class="line">               fill = <span class="string">"skyblue"</span>, colour = <span class="string">"grey"</span>)                        +</div><div class="line">  geom_point(data = cap_bubble, shape = <span class="number">21</span>,</div><div class="line">             aes(cap_long, cap_lat, size = no_car_k,</div><div class="line">                                 fill = growth, alpha = <span class="number">.5</span>))             +</div><div class="line">  scale_fill_gradient(low = <span class="string">"red"</span>, high = <span class="string">"yellow"</span>)                      +</div><div class="line">  scale_size_area(max_size=<span class="number">20</span>)</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot2.png" alt="vis3-plot2"></p>
<p>The bubbles with transparency cannot display the difference clearly when the growth rates are similar across provinces. Let’s try smaller bubbles without specifying the transparency. We can also remove the legend to keep the map simple and clear.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">ggplot()                                                                 +</div><div class="line">  geom_polygon(data = cnmapdf, aes(long, lat, group = group), </div><div class="line">               fill = <span class="string">"skyblue"</span>, colour = <span class="string">"grey"</span>)                        +</div><div class="line">  geom_point(data = cap_bubble, shape = <span class="number">21</span>, colour = <span class="string">"white"</span>,</div><div class="line">             aes(cap_long, cap_lat, size = no_car_k, fill = growth))     +</div><div class="line">  scale_fill_gradient(low = <span class="string">"red"</span>, high = <span class="string">"yellow"</span>)                      +</div><div class="line">  scale_size_area(max_size=<span class="number">15</span>)                                           +</div><div class="line">  theme(legend.position = <span class="string">"none"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot3.png" alt="vis3-plot3"></p>
<p>It seems that from 2008 to 2013, Hainan and Gansu are the 2 provinces with the quickest growth.</p>
<h3 id="Bubbles-by-ggvis"><a href="#Bubbles-by-ggvis" class="headerlink" title="Bubbles by ggvis"></a>Bubbles by <code>ggvis</code></h3><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cnmapdf                                                                 %&gt;%</div><div class="line">  group_by(group)                                                       %&gt;%</div><div class="line">  ggvis(x = ~long, y = ~lat)                                            %&gt;%</div><div class="line">  layer_paths(fill := <span class="string">"skyblue"</span>, stroke := <span class="string">"grey"</span>)                      %&gt;%</div><div class="line">  layer_points(data = cap_bubble, x = ~cap_long, y = ~cap_lat,</div><div class="line">               fill = ~growth, size = ~no_car_k, stroke := <span class="string">"white"</span>)     %&gt;%</div><div class="line">  scale_numeric(<span class="string">"fill"</span>, range = c(<span class="string">"red"</span>, <span class="string">"yellow"</span>))                     %&gt;%</div><div class="line">  scale_numeric(<span class="string">"size"</span>, range = c(<span class="number">50</span>, <span class="number">500</span>))                             %&gt;%</div><div class="line">  hide_legend(scales = c(<span class="string">"fill"</span>, <span class="string">"size"</span>))                               %&gt;%</div><div class="line">  add_axis(<span class="string">"x"</span>, title = <span class="string">"Longitude"</span>)                                    %&gt;%</div><div class="line">  add_axis(<span class="string">"y"</span>, title = <span class="string">"Latitude"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot4.png" alt="vis3-plot4"></p>
<p>To remove the legend, <code>ggvis</code> provides <code>hide_legend()</code>, within this function, you can specify the names of scales to be hidden. </p>
<h2 id="Bar-Charts-on-A-Map"><a href="#Bar-Charts-on-A-Map" class="headerlink" title="Bar Charts on A Map"></a>Bar Charts on A Map</h2><h3 id="Bar-Charts-by-ggplot2"><a href="#Bar-Charts-by-ggplot2" class="headerlink" title="Bar Charts by ggplot2"></a>Bar Charts by <code>ggplot2</code></h3><p>It is more complicated to place a bar chart than plot just a bubble on certain spot.<br>To locate a bubble, you just need to give <code>aes()</code> the coordinates which have nothing to do with the size and color of bubble.<br>Regarding bar chart, we need to assign at least 2 pairs of <code>x</code> and <code>y</code>, one for bar chart location and the other for the height and width of the bar chart. In other words, we need to know the coordinates of 4 corners for a bar.</p>
<p>Since a bar chart may takes more space and looks more complicated than a bubble, we just plot 4 cities.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">p1 &lt;- ggplot()                                                           +</div><div class="line">  geom_polygon(data = cnmapdf, aes(long, lat, group = group), </div><div class="line">               fill = <span class="string">"beige"</span>, colour = <span class="string">"grey"</span>)                          +</div><div class="line">  geom_errorbar(data = cap_bar, size =<span class="number">3</span>, colour = <span class="string">"brown"</span>, </div><div class="line">                alpha = <span class="number">.8</span>, width = <span class="number">0</span>,</div><div class="line">                aes(x = cap_long - <span class="number">1</span>, ymin = cap_lat,</div><div class="line">                    ymax = cap_lat + Y2003 / Y2013 * <span class="number">3</span>))                 +</div><div class="line">  geom_errorbar(data = cap_bar, size =<span class="number">3</span>, colour = <span class="string">"red"</span>, </div><div class="line">                alpha = <span class="number">.8</span>, width = <span class="number">0</span>,</div><div class="line">                aes(x = cap_long, ymin = cap_lat,</div><div class="line">                    ymax = cap_lat + Y2008 / Y2013 * <span class="number">3</span>))                 +</div><div class="line">  geom_errorbar(data = cap_bar, size =<span class="number">3</span>, colour = <span class="string">"orange"</span>, </div><div class="line">                alpha = <span class="number">.9</span>, width = <span class="number">0</span>,</div><div class="line">                aes(x = cap_long + <span class="number">1</span>, ymin = cap_lat,</div><div class="line">                    ymax = cap_lat + Y2013 / Y2013 * <span class="number">3</span>))                 +</div><div class="line">  geom_text(aes(<span class="number">85</span>, <span class="number">24</span>), colour = <span class="string">"brown"</span>, </div><div class="line">            label = <span class="string">"Car Ownership - 2003"</span>)                              +</div><div class="line">  geom_text(aes(<span class="number">85</span>, <span class="number">22</span>), colour = <span class="string">"red"</span>, </div><div class="line">            label = <span class="string">"Car Ownership - 2008"</span>)                              +</div><div class="line">  geom_text(aes(<span class="number">85</span>, <span class="number">20</span>), colour = <span class="string">"orange"</span>, </div><div class="line">            label = <span class="string">"Car Ownership - 2013"</span>)</div><div class="line"></div><div class="line">p1</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot5.png" alt="vis3-plot5"></p>
<p>We could add more details, i.e. the avg. growth rate in the from 2003 to 2013.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># define a function to find the root</span></div><div class="line">root10find &lt;- <span class="keyword">function</span>(x, y)&#123;</div><div class="line">  </div><div class="line">  low &lt;- <span class="number">0</span></div><div class="line">  high &lt;- y/x</div><div class="line">  ans &lt;- (low + high)/<span class="number">2</span></div><div class="line">  </div><div class="line">  <span class="keyword">while</span> (abs(x * ans^<span class="number">10</span> - y) &gt; <span class="number">0.001</span>)&#123;</div><div class="line">    <span class="keyword">if</span> (x * ans^<span class="number">10</span> &lt; y)&#123;</div><div class="line">      low &lt;- ans</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      high &lt;- ans</div><div class="line">    &#125;</div><div class="line">    ans &lt;- (high + low)/<span class="number">2</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span>(ans)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">4</span>)&#123;</div><div class="line">  cap_bar[i,<span class="string">"growth_10y"</span>] &lt;- root10find(cap_bar[i,<span class="string">"Y2003"</span>], cap_bar[i,<span class="string">"Y2013"</span>])-<span class="number">1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">p1                                                                       +</div><div class="line">  ggtitle(<span class="string">"Yearly Growth of Private Vehicles"</span>)                           +</div><div class="line">  geom_text(data = cap_bar, </div><div class="line">            aes(cap_long, cap_lat - <span class="number">0.5</span>,</div><div class="line">                label = paste(prov_en, <span class="string">": "</span>, </div><div class="line">                              round(growth_10y * <span class="number">100</span>, <span class="number">2</span>),</div><div class="line">                              <span class="string">"%"</span>, sep = <span class="string">""</span>)))</div></pre></td></tr></table></figure>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot6.png" alt="vis3-plot6"></p>
<h3 id="Bar-Charts-by-ggvis"><a href="#Bar-Charts-by-ggvis" class="headerlink" title="Bar Charts by ggvis"></a>Bar Charts by <code>ggvis</code></h3><p>It is the same logic to plot by <code>ggvis</code>.<br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">year_labels &lt;- data.frame(long = c(<span class="number">80</span>, <span class="number">80</span>, <span class="number">80</span>),</div><div class="line">                          lat = c(<span class="number">24</span>, <span class="number">22</span>, <span class="number">20</span>),</div><div class="line">                          label = c(<span class="string">"Car Ownership - 2003"</span>,</div><div class="line">                                    <span class="string">"Car Ownership - 2008"</span>,</div><div class="line">                                    <span class="string">"Car Ownership - 2013"</span>),</div><div class="line">                          fill = c(<span class="string">"brown"</span>, <span class="string">"red"</span>, <span class="string">"orange"</span>))</div><div class="line"></div><div class="line">cnmapdf                                                                 %&gt;%</div><div class="line">  group_by(group)                                                       %&gt;%</div><div class="line">  ggvis(x = ~long, y = ~lat, fill := <span class="string">"beige"</span>, stroke := <span class="string">"grey"</span>)         %&gt;%</div><div class="line">  layer_paths()                                                         %&gt;%</div><div class="line">  add_axis(<span class="string">"x"</span>, title = <span class="string">"longtitude"</span>)                                   %&gt;%</div><div class="line">  add_axis(<span class="string">"y"</span>, title = <span class="string">"latitude"</span>)                                     %&gt;%</div><div class="line">  layer_rects(data = cap_bar, fill := <span class="string">"brown"</span>, stroke := <span class="string">"white"</span>,</div><div class="line">              x = ~cap_long - <span class="number">1.5</span>, x2 = ~cap_long - <span class="number">.5</span>,</div><div class="line">              y = ~cap_lat, y2 = ~cap_lat + Y2003 / Y2013 * <span class="number">3</span>)          %&gt;%</div><div class="line">  layer_rects(data = cap_bar, fill := <span class="string">"red"</span>, stroke := <span class="string">"white"</span>,</div><div class="line">              x = ~cap_long - <span class="number">.5</span>, x2 = ~cap_long + <span class="number">.5</span>,</div><div class="line">              y = ~cap_lat, y2 = ~cap_lat + Y2008 / Y2013 * <span class="number">3</span>)          %&gt;%</div><div class="line">  layer_rects(data = cap_bar, fill := <span class="string">"orange"</span>, stroke := <span class="string">"white"</span>,</div><div class="line">              x = ~cap_long + <span class="number">.5</span>, x2 = ~cap_long + <span class="number">1.5</span>,</div><div class="line">              y = ~cap_lat, y2 = ~cap_lat + Y2013 / Y2013 * <span class="number">3</span>)          %&gt;%</div><div class="line">  layer_text(data = year_labels, x = ~long, y = ~lat, </div><div class="line">             text := ~label, stroke := ~fill)                            %&gt;%</div><div class="line">  scale_nominal(<span class="string">"fill"</span>, range = c(<span class="string">"brown"</span>, <span class="string">"red"</span>, <span class="string">"orange"</span>))            %&gt;%</div><div class="line">  layer_text(data = cap_bar, x = ~cap_long -<span class="number">.5</span>, y = ~cap_lat - <span class="number">1</span>,</div><div class="line">             text := ~prov_en, stroke:= <span class="string">"black"</span>, align:=<span class="string">"right"</span>)        %&gt;%</div><div class="line">  layer_text(data = cap_bar, x = ~cap_long +<span class="number">.5</span>, y = ~cap_lat - <span class="number">1</span>,</div><div class="line">             text := ~round(growth_10y*<span class="number">100</span> ,<span class="number">2</span>), </div><div class="line">             stroke:= <span class="string">"black"</span>, align:=<span class="string">"left"</span>)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xndoy.com1.z0.glb.clouddn.com/vis3-plot7.png" alt="vis3-plot7"></p>
<p>I tried to combine the last 2 <code>layer_text()</code> functions together (the chunk below) and add a “%” to the end of the percentage point but it returns <code>undefined</code> at the position which is supposed to be like <code>Beijing 14.78%</code>. Need to figure out why the function does not support multiple embedding.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">layer_text(data = cap_bar, x = ~cap_long -<span class="number">.5</span>, y = ~cap_lat - <span class="number">1</span>,</div><div class="line">           text := ~paste(prov_en, <span class="string">": "</span>, round(growth_10y * <span class="number">100</span>, <span class="number">2</span>),</div><div class="line">                          <span class="string">"%"</span>, sep = <span class="string">""</span>),</div><div class="line">           fill := <span class="string">"black"</span>, align := <span class="string">"center"</span>)</div></pre></td></tr></table></figure>
<hr>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5OTM1NDQwOA==&amp;mid=301839416&amp;idx=1&amp;sn=f301a6e1bde4fd33a7cf5ae26c1488f8&amp;scene=1&amp;srcid=1016dQkNwckBmrGkS36herzL&amp;key=b410d3164f5f798e38fef99f9c537830722ae774347c2d03dc14da24dc3fdf784c5999cba9699fb48fc46911d15bad42&amp;ascene=1&amp;uin=MTU5MzIwMTkxNQ%3D%3D&amp;devicetype=Windows+7&amp;version=61050016&amp;pass_ticket=R%2Bn5ah4D6uROw3ZEyFq5kUficdfwc8CkaKox2zMOP5pj5oAL8M2XaXXXUqT6Mcff" target="_blank" rel="external">刘万祥: ggplot绘制商务图表–热力气泡中国地图</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5OTM1NDQwOA==&amp;mid=308574860&amp;idx=1&amp;sn=d75ec36b8adc1aca2d7947f4df3a9c72&amp;scene=1&amp;srcid=1016YR3jAkt87MM5BrdkdBBU&amp;key=b410d3164f5f798e54adf1f73ea22fd8d4ac056586b21647b2560e8c531c10ff39641ede580b1466863aaccecd48a3ea&amp;ascene=1&amp;uin=MTU5MzIwMTkxNQ%3D%3D&amp;devicetype=Windows+7&amp;version=61050016&amp;pass_ticket=R%2Bn5ah4D6uROw3ZEyFq5kUficdfwc8CkaKox2zMOP5pj5oAL8M2XaXXXUqT6Mcff" target="_blank" rel="external">刘万祥: ggplot绘制商务图表–地图上的迷你柱形图</a></li>
</ol>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/R/" rel="tag">#R</a>
          
            <a href="/tags/ggvis/" rel="tag">#ggvis</a>
          
            <a href="/tags/visualization/" rel="tag">#visualization</a>
          
            <a href="/tags/ggplot2/" rel="tag">#ggplot2</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/10/23/LaVie-6-the-2nd-farewell-letter/" rel="prev">To Say Goodbye Is to...</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/10/15/Codage-11-r-visualization-2-cn-map-2/" rel="next">R Visual. - China Map Part II</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

 </div>

        

        
          <div class="comments" id="comments">
            
              <div class="ds-thread" data-thread-key="2015/10/18/Codage-12-r-visualization-3-bubble-bar-on-map/"
                   data-title="R Visual. - Bubbles and Bar Charts on China Map" data-url="http://elliott828.github.io/2015/10/18/Codage-12-r-visualization-3-bubble-bar-on-map/">
              </div>
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/uploads/avatar_storm_cat_white.png" alt="Papa Cochon" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Papa Cochon</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">70</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">11</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">93</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name"></p>
            
              <span class="links-of-author-item">
              <a href="http://monkey0105.github.io/" target="_blank">大师兄</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Preparation"><span class="nav-number">1.</span> <span class="nav-text">Preparation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bubbles-on-A-Map"><span class="nav-number">2.</span> <span class="nav-text">Bubbles on A Map</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bubbles-with-A-Single-Color-ggplot2"><span class="nav-number">2.1.</span> <span class="nav-text">Bubbles with A Single Color - ggplot2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bubbles-with-Effect-of-Heat-Map-ggplot2"><span class="nav-number">2.2.</span> <span class="nav-text">Bubbles with Effect of Heat Map - ggplot2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bubbles-by-ggvis"><span class="nav-number">2.3.</span> <span class="nav-text">Bubbles by ggvis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bar-Charts-on-A-Map"><span class="nav-number">3.</span> <span class="nav-text">Bar Charts on A Map</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bar-Charts-by-ggplot2"><span class="nav-number">3.1.</span> <span class="nav-text">Bar Charts by ggplot2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bar-Charts-by-ggvis"><span class="nav-number">3.2.</span> <span class="nav-text">Bar Charts by ggvis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Papa Cochon</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

<div class="visit-statistics">
	<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>

	<span id="busuanzi_container_site_pv">
		<span id="busuanzi_value_site_pv"></span> hits from
	</span>
	
	<span id="busuanzi_container_site_uv">
		<span id="busuanzi_value_site_uv"></span> visitors 
	</span>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"papacochon"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     
  	<script src="/js/ua-parser.min.js"></script>
  	<script src="/js/hook-duoshuo.js"></script>
  

    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
